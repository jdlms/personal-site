---
import Layout from "../layouts/Layout.astro";

const response = await fetch(
  "https://get_bookmarks.jdlms.dev"
);

type Bookmarks = {
  id: number;
  title: string;
  summary: string;
  url: string;
  published: string;
};

function formatDate(published: string): string {
  const date = new Date(published);

  const month = date.getMonth() + 1;
  const year = date.getFullYear();

  const formattedMonth =
    month < 10 ? `0${month}` : month.toString();

  return `${formattedMonth}/${year}`;
}

function sortNewestToOldest(data: Bookmarks[]) {
  return data.sort(
    (a, b) =>
      new Date(b.published).getTime() -
      new Date(a.published).getTime()
  );
}

const unsortedBookmarks: Bookmarks[] =
  await response.json();

const bookmarks: Bookmarks[] = sortNewestToOldest(
  unsortedBookmarks
);

bookmarks.map((item) => {
  item.published = formatDate(item.published);

  console.log(item);
});
---

<Layout title="jdlms.dev">
  <div class="wrapper">
    <p>
      An auto-updating list of good reads from around the
      web.
    </p>
    <ul>
      {
        bookmarks.map((item: any) => (
          <>
            <li>
              <a href={item.url}>{item.title}</a>
              <span>{item.published}</span>
            </li>
          </>
        ))
      }
    </ul>
  </div>
</Layout>

<style>
  .wrapper {
    @apply flex flex-col justify-center items-center  text-my-off-white;
  }

  p {
    @apply italic text-xs;
  }

  ul {
    @apply space-y-2 md:space-y-8 mt-6 md:mt-10;
  }

  li {
    @apply flex flex-row space-x-6 items-start justify-center;
  }

  a {
    @apply underline decoration-my-accent w-52 md:w-96;
  }

  span {
    @apply inline-block text-my-orange text-xs m-0;
  }
</style>
<!-- 
{                                                                            │
  id: 4406622707,                                                            │
  title: "Friends don't let friends export to CSV",                          │
  summary: "I worked for a few years in the intersection between data science│
and software engineering. On the whole, it was a really enjoyable time and I'd│
like to have the chance to do so again at some point. One of the least enjoyab│
le experiences from that time was",                                            │
  url: 'https://kaveland.no/friends-dont-let-friends-export-to-csv.html',    │
  published: '2024-03-23T23:00:00.000000Z'                                   │
}      -->
